~/workspace$ python test_endpoints.py
ğŸ§ª Starting Mambo Bot Test Suite...
Testing against: http://127.0.0.1:5000

ğŸ” Testing Health Endpoints...
âœ… PASS Root endpoint - Status: 200
âœ… PASS Health endpoint - DB: connected

ğŸ” Testing Webhook Verification...
âœ… PASS Webhook verification (valid) - Response: test_challenge_123
âœ… PASS Webhook verification (invalid) - Status: 403

ğŸ” Testing Message Processing...
âœ… PASS Message processing (onboarding) - Status: 200
âœ… PASS Message processing (meal request) - Status: 200

ğŸ” Testing Intent Classification...
âœ… PASS Intent: 'What should I eat for dinner?...' - Got: WHATSDINNER, Expected: WHATSDINNER
âœ… PASS Intent: 'How to make butter chicken?...' - Got: RECIPE_REQUEST, Expected: RECIPE_REQUEST
âœ… PASS Intent: 'I have rice and vegetables, wh...' - Got: PANTRY_HELP, Expected: PANTRY_HELP
Error classifying intent with OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: -proj-fJ******************************************************************************************************************************************************T2AA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
âŒ FAIL Intent: 'Plan my meals for this week...' - Got: OTHER, Expected: PLANWEEK
âœ… PASS Intent: 'I'm craving something spicy...' - Got: MOOD, Expected: MOOD
âœ… PASS Intent: 'Do you have vegan options?...' - Got: DIETARY_QUERY, Expected: DIETARY_QUERY
Error classifying intent with OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: -proj-fJ******************************************************************************************************************************************************T2AA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
âœ… PASS Intent: 'Random text here...' - Got: OTHER, Expected: OTHER

ğŸ” Testing Database Operations...
Error creating user: 'SyncQueryRequestBuilder' object has no attribute 'select'
âŒ FAIL User creation - User ID: None
âœ… PASS Meal search - Found 0 meals
âœ… Successfully added 16 Indian meals to database
âœ… PASS Meal population - Population result: True

ğŸ” Testing Image Processing...
âœ… Google Cloud Vision client initialized
âœ… PASS Image fallback ingredients - Got 5 ingredients
âœ… PASS Ingredient suggestions - Got 3 suggestions

ğŸ“Š Test Summary:
Passed: 16/18

âŒ Failed Tests:
  - Intent: 'Plan my meals for this week...': Got: OTHER, Expected: PLANWEEK
  - User creation: User ID: None

âš ï¸ Some tests failed. Check the details above.
~/workspace$ 
~/workspace$ python test_twilio_integration.py
ğŸš€ Starting Twilio Integration Tests...
ğŸ§ª Testing Twilio Integration...

ğŸ“± Testing Twilio Client...
âœ… Twilio client initialized
âœ… Twilio client initialized
âœ… Twilio connection test successful. Account: homeyease
âœ… Twilio connection test passed
âš ï¸ No TEST_PHONE_NUMBER set, skipping SMS test

ğŸ”„ Testing Message Adapter...
âœ… SMS to WhatsApp format conversion works
âœ… Interactive response parsing works

ğŸ”€ Testing Hybrid Message Handler...
âœ… Google Cloud Vision client initialized
âœ… Twilio client initialized
ğŸ“± Communication channels: WhatsApp=True, Twilio=True
âœ… Twilio connection test successful. Account: homeyease
ğŸ“Š Channel Status: {'whatsapp_cloud_api': {'available': True, 'configured': True}, 'twilio_sms': {'available': True, 'configured': True}, 'twilio_whatsapp': {'available': True, 'configured': True}, 'twilio_connection_test': True}

ğŸ¯ Twilio Integration Test Complete!

ğŸŒ Testing Webhook Simulation...
âŒ Failed to initialize Google Cloud Vision: Expecting value: line 1 column 1 (char 0)
Error getting user by whatsapp_id: {'message': 'Cannot coerce the result to a single JSON object', 'code': 'PGRST116', 'hint': None, 'details': 'The result contains 0 rows'}
Error getting user by whatsapp_id: {'message': 'Cannot coerce the result to a single JSON object', 'code': 'PGRST116', 'hint': None, 'details': 'The result contains 0 rows'}
Error sending WhatsApp message: Client error '400 Bad Request' for url 'https://graph.facebook.com/v17.0/776951448837189/messages'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400
âœ… SMS webhook simulation successful
Error getting user by whatsapp_id: {'message': 'Cannot coerce the result to a single JSON object', 'code': 'PGRST116', 'hint': None, 'details': 'The result contains 0 rows'}
Error getting user by whatsapp_id: {'message': 'Cannot coerce the result to a single JSON object', 'code': 'PGRST116', 'hint': None, 'details': 'The result contains 0 rows'}
Error sending WhatsApp message: Client error '400 Bad Request' for url 'https://graph.facebook.com/v17.0/776951448837189/messages'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400
âœ… WhatsApp webhook simulation successful